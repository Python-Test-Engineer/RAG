import psycopg2
from uuid import uuid4

# Establishing the connection
conn = psycopg2.connect(
    database="postgres",
    user="postgres",
    password="postgres",
    host="host.docker.internal",
)
if conn:
    print(f"Conn: {conn}\n")
else:
    print("NO CONNECTION\n")

cursor = conn.cursor()

TABLE_NAME = "tbl_doc_elements"

try:
    postgres_insert_query = f""" 
        INSERT INTO {TABLE_NAME} (file_id, element_text, embedding)
        VALUES ('c3065f25-34bd-433d-b6d3-71e5f7603e42', 'Here is a lot of text that we will embed',(ARRAY[0.023209529,0.023142641,0.031168992,0.016092831,-0.019182976,0.026192656,0.0064378013,-0.031436536,-0.042619918,-0.043128252,0.028573805,0.0321054,-0.030714165,-0.008962757,-0.023503827,-0.014193262,-0.030312847,0.0003841779,-0.015316951,0.004635217,-0.014848747,0.023610845,0.033282597,0.016855335,-0.018005779,-0.016132964,-0.011644896,0.020199647,-0.01566476,0.045669932,0.032506716,-0.03603831,-0.01755095,-0.022433648,0.011002788,-0.0035683813,0.040800612,-0.013557843,-0.0061702565,-0.00329582,0.008146745,-0.017831873,-0.022687815,0.039222095,0.019236485,-0.0018243224,-0.053910315,0.004551609,-0.019182976,0.04722169,-0.0009497847,-0.058485337,-0.016333621,0.057361647,-0.04548265,-0.03098171,0.007839069,0.02753038,0.025336511,0.042432636,0.009752015,-0.00607996,-0.0034446418,0.011745226,-0.017885383,0.020106006,0.0088022305,0.03293479,-0.008594883,-0.040158503,-0.037830863,0.0683845,-0.019718066,-0.014621334,-0.028145734,0.035770766,-0.021858426,0.009738638,0.017189765,-0.00059027114,-0.025737828,0.03989096,-0.024212822,-0.015811909,0.016454017,-0.014313657,-0.033229087,-0.00052714726,-0.03245321,0.01784525,0.0056652655,-0.020427061,-0.0659766,-0.005300735,0.005919433,-0.032961544,0.013236789,-0.036305856,-0.02120294,0.0011654929,-0.016962353,-0.04358308,-0.01965118,-0.00831396,0.016721562,0.042539652,0.009705194,-0.023677733,-0.0041971123,-0.003394477,-0.077962615,-0.024400104,-0.025202738,0.0419243,-0.06035815,0.0041603246,-0.013872208,-0.058164284,0.010688422,-0.025229493,-0.025349889,-0.0033576896,0.002483152,-0.020320043,-0.014915633,0.008956069,0.015597873,-0.033683915,-0.03424576,-0.027503625,-0.046392303,-0.011062985,0.051823467,-0.05559585,-0.022232989,0.024814798,-0.0236376,0.005190373,-0.037376035,-0.04775678,0.0033158858,0.022554044,0.044680014,-0.01036068,-0.0073039783,-0.003662022,0.0064110467,0.012287004,0.011484369,0.0011253612,-0.017163012,0.041282192,0.027717661,0.052840136,0.012313758,-0.029108895,0.044198435,-0.01813955,-0.011878998,-0.02666086,-0.037697088,0.012561237,-0.0012457564,0.032827772,0.064317815,0.059502006,0.04476028,-0.02383826,-0.097386375,-0.0013293641,0.010146644,0.017965646,0.022647684,-0.020025743,-0.017484065,-0.011858932,0.015196555,0.007845757,0.0074645053,0.01405949,0.033978213,0.06260553,-0.04363659,-0.032693997,-0.05107434,0.0126749445,0.036573403,0.022406893,-0.007651787,-0.011845554,0.0013001014,0.019182976,0.04494756,0.038258933,0.026915027,0.0071568284,0.010139955,-0.05602392,0.085239835,-0.053241454,-0.00068432995,0.009230303,-0.03609182,0.008675147,0.060144115,-0.03978394,0.0042038006,-0.019477276,-0.008695212,0.0368677,0.06635116,-0.014969142,0.02397203,0.040238768,-0.0059495317,-0.0025935143,-0.037295774,-0.024801422,0.019343503,0.03205189,-0.023410186,0.016346999,0.033443123,0.038205426,-0.017256653,-0.0092905,-0.005220472,0.039569903,0.016694808,0.030660657,-0.059555516,-0.0030567015,-0.0018142895,-0.011243578,0.003822549,0.029322932,-0.049495824,-0.063301146,-0.0059094,0.019330125,0.00079594634,-0.012387333,-0.004869319,0.0016989107,0.015878795,0.0006337472,0.015437346,-0.038312443,-0.00016345327,0.017617838,0.064585365,-0.00066217384,0.044680014,-0.024092427,-0.0014890551,0.009270434,0.012661567,0.006584951,-0.0034981507,0.008635014,0.017925514,-0.03293479,-0.01055465,0.0050800107,0.07148802,0.016173095,0.027048798,0.009136662,0.0003350583,-0.017564328,0.061053768,-0.05404409,0.009832279,-0.0064478344,0.0031185714,0.021309959,0.019584294,0.05150241,-0.02387839,-0.0035583484,-0.02242027,-0.006862529,0.0014597924,-0.019477276,-0.012661567,0.035396203,-0.01468822,-0.0036218904,-0.00044730178,-0.032774262,-0.019570917,-0.038151916,0.0027440083,-0.025229493,-0.0042773755,0.03419225,0.035663746,-0.04826512,-0.03191812,0.00036515712,0.069133624,-0.015838664,-0.037483055,-0.012240184,-0.008206943,0.053241454,-0.020253155,-0.010501141,0.0067287567,0.030072058,-0.022460403,-0.05000416,-0.031142237,-0.070417844,-0.025657564,-0.016266735,0.04810459,0.0048358757,0.0043643275,-0.039810695,0.06051868,-0.044037905,0.006949481,-0.0012432481,0.03574401,-0.0010944263,0.05597041,-0.021283204,0.013089639,-0.041897546,0.011798734,-0.06586958,0.06619063,-0.014995897,0.018019155,0.014942388,0.03970368,-0.052519083,0.049736615,0.033550143,-0.02125645,-0.05029846,-0.018808413,0.0006003041,-0.02544353,-0.0064378013,-0.012755208,-0.031222502,-0.008073171,0.0042338995,-0.028573805,-0.066939756,0.01430028,-0.006207044,-0.00890256,-0.0091767935,0.09401531,0.012086345,-0.017885383,0.016320245,-0.0014597924,0.010494452,-0.0033025085,0.031677328,-0.00014600014,0.023329923,-0.058699373,0.0108823925,0.028440032,0.024105804,-0.017671347,-0.024507122,0.037616827,-0.017965646,-0.050137933,0.050940566,-0.0027222703,-0.018380342,0.0630336,-0.021671144,0.012748519,-0.0073708645,-0.001989866,0.0010267039,0.017497443,0.041389212,-0.02544353,0.03253347,-0.0066183945,-0.026620727,-0.0073574875,0.010347303,0.013952471,-0.004889385,0.0030249306,-0.027369853,0.0039329114,0.018407095,-0.0006479605,-0.049495824,-0.004979681,-0.016333621,0.017350294,-0.0070564994,0.0010041298,0.024279708,0.012982621,0.016654676,-0.047194935,-0.020306665,0.020788247,-0.05832481,0.019918725,-0.035663746,0.0059428434,-0.004969648,-0.007939397,-0.0105947815,-0.0006759692,0.060679205,-0.05629147,-0.007986218,0.04227211,-0.026567219,-0.01902245,-0.029403195,0.0439844,-0.047542747,0.053000662,-0.033416368,-0.06736783,0.033095315,0.005447885,0.0086283265,0.009410895,0.04294097,0.006006385,-0.049094506,0.03288128,0.008247075,-0.048318624,-0.004367672,0.06196342,-0.0073507987,0.0014322018,0.023022247,-0.02402554,0.0053676213,-0.01201277,0.06078622,-0.028787842,-0.02354396,0.015718268,-0.036359366,-0.024988702,0.019397013,-0.025082342,-0.03542296,0.040934384,0.032212418,0.017831873,-0.05209101,0.007758805,0.02096215,-0.013791945,-0.016213227,0.07865823,0.020373551,-0.02188518,-0.042245355,0.005116798,0.004655283,0.01965118,0.025523793,0.006207044,-0.017885383,-0.012166609,-0.02548366,-0.00571543,-0.016119586,0.012587992,-0.014046112,0.021778163,0.032479964,-0.049335297,0.0082805175,-0.022246366,-0.03199838,-0.059716042,0.041844036,0.006217077,0.061214294,-0.031784344,-0.015691513,-0.02723608,-0.01444743,-0.029483458,-0.042700183,0.0012131493,-0.016962353,-0.008982823,0.015250064,0.01892881,-0.03199838,0.029296177,0.01692222,-0.017109502,-0.009892476,0.015918927,0.032720752,0.0058625797,-0.00442787,-0.022353385,-0.010634913,-0.010066381,-0.0071434514,0.014594579,0.03194487,-0.020400306,0.0484524,0.014862125,0.010434255,0.01089577,0.00683243,-0.010066381,-0.0033576896,-0.01167165,-0.0588599,0.045348875,-0.011932507,-0.010099824,-0.007043122,-0.0076718526,0.016761694,0.013089639,-0.037054982,0.007203649,0.022166103,-0.0034546747,0.005822448,0.028680824,0.015932305,0.010046314,-0.028413279,-0.030714165,-0.023905145,-0.010855638,0.021845048,0.0004376869,0.051127847,0.03312207,0.005126831,-0.02431984,0.018286701,0.033550143,-0.011718471,0.03312207,0.03871376,0.010521207,0.030500129,0.016721562,0.010414189,-0.009624931,0.03039311,-2.2900702e-05,0.018808413,0.04187079,-0.0023711175,0.0022925262,0.012574615,-0.02183167,-0.035636995,0.023744619,-0.008213631,0.008233697,0.029296177,0.022687815,0.009156727,-0.0028326327,-0.05880639,0.013129771,0.013437447,0.004056651,-0.019758198,-0.026232786,0.041710265,-0.01415313,-0.005705397,0.011109806,-0.0073775533,-0.017256653,0.017082747,-0.013845453,0.015638005,0.005705397,-0.05190373,0.008213631,0.00374563,-0.014781861,0.006414391,-0.03496813,-0.0012674944,-0.0008937675,0.0219922,0.019209731,0.006003041,0.019463899,-0.0071233856,-0.03483436,-0.0035717257,-0.03900806,0.013591286,0.023410186,-0.023503827,0.03847297,-0.01721652,0.020748114,0.02077487,0.008140056,0.0104075,-0.005029846,-0.0029630607,-0.004464657,-0.014567825,0.015865419,0.011745226,-0.01955754,-0.03389795,-0.012233495,0.011939195,0.02913565,-0.028814595,-0.0335769,-0.01989197,-0.02203233,-0.0042974413,0.022246366,0.03448655,0.020025743,-0.022500534,0.008354092,0.023089133,-0.009183482,0.011350596,0.00870859,0.017497443,-0.008033038,-0.013216723,0.012407399,0.013725058,-0.022299875,-0.020106006,-0.015383837,0.0028961746,0.036707174,-0.046392303,0.0149290105,0.035396203,-0.025283001,-0.018781658,-0.00860826,-0.015049406,-0.030098813,0.035958048,0.0092637455,0.012581304,0.024988702,-0.008012973,0.017604461,-0.016400509,-0.03039311,0.01512967,0.018688018,0.043502815,0.037054982,-0.03419225,0.021577504,-0.026674235,0.020520702,-0.008200254,0.011899063,-0.0017081075,-0.05201075,-0.056344975,0.01167165,-0.029884776,0.017979024,0.0118656205,-0.003501495,0.013116393,-0.03205189,0.0035616928,-0.0019129467,0.002891158,0.0127618965,0.0143805435,0.02690165,-0.016989106,0.004274031,-0.0689731,0.011531189,0.0009364075,-0.030794429,-0.010588093,0.0072972896,-0.007852445,-0.03074092,-0.034700587,0.058003753,-0.013845453,-0.010902459,0.0010777047,-0.02889486,0.015183179,0.0004882696,-0.011718471,0.028734332,0.03531594,0.0018744871,0.004334229,0.02291523,-0.0077521163,-0.022059085,0.012628124,0.00043810494,0.0016930582,-0.030821184,0.02339681,-0.021069169,-0.03389795,0.01288898,-0.004026552,0.011350596,0.0062337983,0.01507616,0.023182774,-0.028814595,-0.008119991,-0.012333824,-0.001178034,0.032560226,0.003105194,-0.026206031,-0.03965017,0.015571118,0.041175175,0.018447228,0.025135852,-0.037028227,0.016507527,-0.015062783,0.01089577,-0.014848747,-0.020453814,0.017577706,-0.035636995,0.016962353,-0.02048057,0.010628225,-0.013203345,0.0439844,-0.0067856098,0.00953129,-0.01721652,0.034459796,-0.0069227265,-0.03681419,0.030660657,0.0068558403,0.019544162,-0.024159312,-0.00734411,-0.008701901,0.009297188,0.0031520145,0.019517407,-0.026032127,0.017055994,0.0010802129,0.008407601,-0.027008668,0.00021246835,0.00089962006,-0.004735546,-0.044920806,0.0047054477,0.020199647,0.0008703573,-0.014567825,-0.017644592,-0.03146329,-0.0033894607,-0.014233394,-0.016601168,0.019410389,0.0107954405,0.004625184,-0.064478345,-0.024212822,0.012166609,0.0380449,-0.024961948,-0.0009882443,-0.0074645053,0.02758389,-0.009892476,-0.0647994,-0.0078056254,-0.03579752,-0.037376035,-0.020360174,0.02937644,-0.0061033703,-0.012106411,-0.011363974,-0.010113201,0.0017624527,-0.018286701,0.012728453,0.005477984,0.04858617,0.00413357,-0.020614343,0.0029346342,0.0030801117,0.0018259946,0.0017975679,-0.016159717,0.028145734,0.027878188,0.039944466,-0.007578212,-0.038794026,-0.0014840387,0.008400912,-0.029858021,-0.008735344,-0.03365716,-0.03140978,0.03726902,-0.033550143,-0.017283406,0.006969547,0.007845757,-0.020065874,-0.0019430455,0.025202738,-0.0069628586,0.011363974,0.012775273,-0.02242027,0.017577706,-0.01507616,-0.013898962,-0.03847297,0.034647077,-0.027169194,0.03330935,0.0143805435,-0.018420473,-0.03293479,-0.0075849006,0.026099015,0.008996201,-0.006989613,-0.0035349382,-0.009190171,-0.031730838,0.014915633,0.006658526,-0.000759577,-0.029322932,-0.020707982,-0.011698405,0.030847939,0.0018126173,-0.018714773,0.004825843,0.04577695,-0.008594883,-0.0059662536,-0.028413279,0.010668357,-0.029590476,0.012313758,0.032747507,-0.0659766,0.014942388,0.03199838,7.900938e-05,0.0040098308,0.009123284,-0.0032908034,-0.00078967575,0.012822093,-0.01108974,-0.000963162,0.0055615916,0.012333824,-0.06586958,0.011109806,0.0134842675,-0.019463899,0.025590679,-0.003019914,0.018902054,-0.012929112,0.018393718,0.0047990885,0.028707579,-0.010394123,-0.015731646,0.05072653,-0.0019881937,0.0043308847,0.050030913,-0.005220472,0.007939397,0.011256956,-0.028225997,0.020922018,0.0057421844,0.029643985,0.0062137325,0.042914215,0.02607226,-0.010340614,0.015183179,-0.00496296,-0.017055994,0.038633496,0.019316748,-0.059234463,-0.005782316,-0.011377351,0.01537046,0.019932102,-0.005083355,-0.004795744,-0.027503625,-0.0216979,0.005287358,0.027610643,-0.0011654929,-0.012400711,-0.045643177,0.025858223,0.018326832,-0.023169396,0.0009029644,0.005675298,-0.029001877,0.039222095,-0.005588346,-0.029991794,-0.01979833,0.012173297,0.019102713,0.043262027,-0.026085638,0.0018644541,-0.026848141,-0.015316951,0.022687815,0.020132761,-0.016614543,0.028359769,-0.015464101,0.014902256,0.048024327,-0.009517913,-0.014701597,0.028654069,-0.011076363,-0.034593567,0.0041302256,0.022018952,0.00037811633,-0.012427465,-0.04762301,-0.007885889,0.034593567,-0.008982823,-0.010949279,0.046178266,-0.00016784268,-0.013430758,0.013604663,0.02383826,-0.0044579683,0.022433648,-0.0052739806,-0.0216979,0.017564328,0.0020835067,-0.016280113,0.015878795,-0.0035917915,0.036305856,-0.017256653,0.03330935,2.6832882e-05,-0.0041469475,-0.00045733474,-0.016948976,-0.00057396764,-0.020373551,0.0061468463,-0.0030801117,-0.005919433,-0.0051636184,0.004070028,0.0018912087,0.012213429,0.019049203,-0.0072772237,0.039141834,-0.01498252,-0.038606744,-0.027610643,-0.0034747405,0.014674843,0.0013720042,-0.0010417533,-0.028038716,-0.023209529,0.014393921,0.0007587409,0.02884135,0.022447025,-0.0014322018,0.0038058276,-0.009103218,-0.012414088,-0.033496633,0.0356905,-0.03536945,-0.0041469475,-0.0015266787,0.00520375,0.009537979,0.021845048,0.008648392,-0.012601369,0.027369853,-0.04601774,-0.006839119,0.037242264,0.04577695,0.00015331582,-0.010949279,0.020935396,-0.040104996,0.008521308,-0.0038359263,0.0003682924,-0.028868105,-0.030366357,-0.0029396506,-0.0006140994,-0.010012872,0.013283609,-0.0012750191,-0.025470283,0.007966152,0.019156221,-0.05155592,-0.035396203,0.009959362,-0.0016637954,0.024547253,-0.0049830256,0.0093506975,-0.003555004,-0.024908438,0.032265928,0.004270687,0.013383938,0.0013770206,0.024547253,0.041951057,0.004267343,-0.0019698,-0.011424171,-0.030419866,0.008033038,-0.023075756,0.010634913,0.013939094,0.0063073733,0.019718066,-0.03472734,-0.012775273,-0.009410895,0.0025834814,0.005618445,-0.025991997,0.008909249,0.032506716,-0.031356275,0.0110562965,0.015932305,0.007243781,0.01834021,0.019330125,0.03371067,0.017323539,-0.017042616,-0.037081737,0.023677733,0.013123082,0.017390424,0.00019971815,0.026915027,0.03681419,0.024828175,-0.03823218,0.00040236258,-0.017082747,-0.0066117058,-0.0015459084,-0.034754094,-0.016694808,0.03609182,0.010574716,0.014781861,-0.0060231066,-0.01337725,-0.028038716,0.007885889,0.010802129,0.03472734,-0.0023844948,0.0040867496,0.0036519892,-0.049602844,-0.04382387,0.011310465,0.014594579,0.006113403,0.010955968,-0.006069927,-0.04363659,0.020172892,0.025068967,-0.0010944263,-0.02461414,0.07860472,-0.002354396,-0.012708387,-0.050646268,-0.020694606,-0.00083440595,-0.0109961,0.025363265,-0.025590679,-0.0013184951,0.009129973,-0.004324196,0.02003912,0.010139955,0.02884135,0.017002484,-0.00518034,0.03264049,0.009558045,-0.0057421844,0.005126831,-0.029510213,0.053294964,0.02271457,-0.0034111987,0.0014522676,-0.0020082595,-0.014434053,0.0048057768,-0.015852042,0.016948976,0.011644896,0.044011153,0.026192656,-0.000974031,-0.0031520145,-0.008441045,-0.0038325822,0.010099824,-0.02942995,0.015330329,-0.012929112,0.0026286296,0.025363265,0.028359769,0.015878795,-0.061000258,-0.041228686,-0.003993109,-0.012407399,-0.019570917,-0.021898558,-0.00549805,0.0028242718,-0.0055916905,-0.006732101,0.013189969,0.008768788,0.009905853,0.004431214,-0.010654979,0.021176185,-0.0019631113,-0.026981913,-0.009578111,-0.010467698,0.005053256,0.0022390173,-0.025082342,0.06271255,0.03293479,-0.010026249,-0.02354396,-0.007772182,-0.007778871,0.026767876,-0.0018276668,0.0010860654,-0.02023978,0.031088728,-0.019998988,0.012052902,0.041389212,-0.00025019638,-0.041121665,0.012467597,-0.009511225,0.032158908,0.022273121,0.007524703,-0.008768788,-0.018500736,-0.0028543707,0.0130227525,0.0062371427,-0.013711681,-0.049602844,-0.018621132,-0.034459796,0.06083973,0.0062772743,0.023757996,-0.03098171,0.0058458582,-0.042566407,0.028654069,-0.037804108,-0.021751408,-0.017537575,0.018032532,0.003585103,0.0056418553,0.029456703,0.0071902717,-0.001552597,0.0045883968,0.027062176,-0.05019144,-0.0021821638,0.0032172285,-0.008427667,0.029082142,-0.00329582,-0.015209933,-0.0013728403,-0.026139146,0.0033259187,-0.019182976,0.015811909,-0.0045549534,-0.041335702,0.036493137,-0.0040800613,0.012628124,0.029938284,-0.018581,0.03234619,-0.027008668,0.019865217,0.023370055,-0.061214294,0.035128657,0.014701597,-0.013711681,-0.012909046,-0.014781861,-0.038151916,-0.050619513,-0.03317558,0.017149635,0.010634913,-0.018808413,-0.019918725,0.0016545986,0.011685028,0.01537046,-0.017136257,-0.010728554,-0.00442787,-0.0066016726,-0.018126173,-0.008387536,0.01629349,-9.307901e-06,0.0076584755,0.0092905,-0.024159312,0.010527896,-0.004514822,-0.020627718,0.021336714,-0.04799757,-0.03199838,0.022487156,0.0011487714,-0.019410389,-0.02003912,0.0157584,-0.00466866,0.044680014,-0.035182167,-0.03753656,0.035262432,0.027931698,-0.0066217384,0.0100730695,0.023691108,-0.03039311,-0.02179154,0.00025082345,0.024052296,0.026981913,-0.023436941,0.014246771,0.00036662025,-0.025068967,0.015036029,0.014434053,0.025068967,3.5872978e-05,-0.018072665,0.035396203,-0.0014923994,-0.04061333,0.052973907,0.008956069,-0.00147735,-0.029831266,-0.010541272,0.018808413,0.0059261215,0.033041805,0.0060966816,0.03924885,0.01551761,0.00469207,-0.0016830253,0.035877783,0.012962555,-0.043556325,-0.0061501907,-0.02003912,0.01269501,-0.026085638,-0.023236282,-0.0047589564,0.03721551,-0.010661668,0.024574008,-0.005671954,0.001755764,-0.025791338,-0.009083153,-0.022273121,0.0072839125,-0.026513709,-0.012052902,-0.019009072,-0.0040733726,-0.0049596154,-0.01712288,-0.017042616,-0.0021152776,0.03317558,-0.017015861,0.07116697,0.026339805,-0.015410592,0.0076651643,0.01668143,0.020841755,-0.018848544,-0.019677935,-0.03419225,-0.032506716,-0.011611452,-0.0068892837,0.00749126,0.006407703,-0.04542914,0.0374563,-0.020400306,0.0043743607,0.05875288,-0.0362791,-9.209923e-07,0.010293794,0.013544465,0.008240386,0.023704486,-0.0033459845,-0.0080798585,0.023998786,-0.009116596,0.0047455793,0.04120193,0.04863968,-0.013156525,0.030660657,-0.06469238,-0.0019279962,-0.017885383,-0.0044245254,0.012179986,-0.0019982266,-0.02397203,-0.00020828797,0.011457615,0.0044780346,-0.004859286,-0.0010843934,-0.008133368,-0.011170004,0.023918523,0.045215104,0.022246366,-0.0004326704,-0.04995065,0.008380847,-0.016841957,-0.0076718526,0.016748317,-0.018219814,0.025430152,0.002397872,0.035958048,0.015464101,-0.03906157,0.00018686346,-0.026888272,-0.009752015,0.017979024,-0.063194126,-0.011116494,0.01201277,-0.0029396506,0.030607147,0.012059591,-0.010206842,0.04465326,0.012815406,0.005140208,0.028627314,-0.016346999,0.05340198,0.028092224,0.0135712195,-0.011959261,0.012266938,-0.0368677,-0.004752268,0.012313758,-0.003158703,0.009477781,0.03127601,-0.017310161,0.010146644,-0.016266735,-0.04524186,-0.010026249,-0.02330317,0.0058291364,-0.031597063,0.003662022,-0.008815608,0.02417269,0.005899367,-0.009283811,0.06651168,0.00496296,0.012200052,-0.011283711,0.0029814546,-0.047301956,0.023089133,-0.037242264,0.024359971,0.023918523,0.0019330126,0.0056987084,-0.010775374,-0.013444136,-0.005300735,0.0022774767,-0.018300077,-0.032185663,0.00018811757,0.02149724,-0.012006082,-0.0067922985,0.007885889,0.012601369,0.02753038,-0.015678138,0.044198435,-0.03146329,0.012862226,-0.011899063,-0.022059085,0.03205189,-0.016413886,-0.0021370156,-0.03938262,0.026580594,-0.037723843,-0.0014572841,-0.0071033197,0.014139753,-0.0036753993]));       
    """

    cursor.execute(postgres_insert_query)

    conn.commit()
    count = cursor.rowcount
    print(
        count,
        f"Record inserted successfully into {TABLE_NAME} table",
    )

except (Exception, psycopg2.Error) as error:
    print(f"Failed to insert record into {TABLE_NAME} table", error)

try:
    postgreSQL_select_Query = f"select * from {TABLE_NAME}"

    cursor.execute(postgreSQL_select_Query)
    print(f"\nSelecting rows from {TABLE_NAME} table using cursor.fetchall")
    records = cursor.fetchall()

    for row in records:
        print(
            "doc_id = ",
            row[0],
        )
        print("filename = ", row[1])


except (Exception, psycopg2.Error) as error:
    print("Error while fetching data from PostgreSQL", error)


cursor.close()
conn.close()
print("PostgreSQL connection is closed")
